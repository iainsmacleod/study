<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Study Guide</title>
    <link rel="stylesheet" href="styles.css?v=7">
    <!-- https://4.files.edl.io/9409/06/12/25/175450-e553e8d3-0176-4d6e-83ab-d19fb87e2427.pdf -->
</head>
<body>
    <div class="container">
        <header id="mainHeader">
            <h1 id="headerTitle" style="cursor: pointer;">Math Study Guide</h1>
            <p class="subtitle">Practice problems and track your progress</p>
            <div class="auth-section" id="authSection" style="display: none;">
                <button class="btn btn-stats" id="statsBtn" style="display: none;">Stats</button>
                <button class="btn btn-user-email" id="userEmailBtn" style="display: none;">
                    <span id="userEmailText"></span>
                </button>
            </div>
        </header>

        <!-- Unified Login/Guest/Admin Selection Screen (First Screen) -->
        <div id="loginGuestSelection" class="selection-screen">
            <h2>Choose how you'd like to proceed</h2>            
            <div class="auth-options">
                <button id="continueAsGuestBtn" class="btn btn-primary btn-large">Continue as Guest</button>
                <button id="loginFromSelectionBtn" class="btn btn-auth btn-large">Login with Google</button>
                <button id="adminFromSelectionBtn" class="btn btn-admin btn-large">Admin</button>
            </div>
            <p class="auth-note">Guests can practice but progress won't be saved. Login to track your progress and view statistics.</p>
        </div>

        <!-- Course Selection Screen -->
        <div id="courseSelection" class="selection-screen" style="display: none;">
            <h2>Choose Course</h2>
            <p class="selection-subtitle">Select a course to study</p>
            
            <div class="back-button-container">
                <button id="backToLoginBtn" class="btn btn-success">← Back</button>
            </div>
            
            <div class="course-tags" id="courseTags">
                <!-- Courses will be loaded here -->
            </div>
        </div>

        <!-- Category Selection Screen -->
        <div id="categorySelection" class="selection-screen" style="display: none;">
            <h2>Choose Categories</h2>
            <p class="selection-subtitle">Select one or more categories, or choose Random for all categories</p>
            
            <div class="back-button-container">
                <button id="backToCourseBtn" class="btn btn-success">← Back to Courses</button>
            </div>
            
            <div class="category-tags" id="categoryTags">
                <!-- Random and categories will be loaded here -->
            </div>
            
            <div class="question-count-selector">
                <label>Number of Questions:</label>
                <div class="count-buttons">
                    <button class="count-btn" data-count="5">5</button>
                    <button class="count-btn" data-count="10">10</button>
                    <button class="count-btn" data-count="20">20</button>
                    <button class="count-btn" data-count="30">30</button>
                    <button class="count-btn active" data-count="all">All</button>
                </div>
            </div>
            
            <button id="startStudyBtn" class="btn btn-primary btn-large" disabled>Start Study</button>
        </div>

        <!-- Main Content (hidden initially) -->
        <div id="mainContent" class="main-content" style="display: none;">
            <div class="controls">
                <button id="newStudyBtn" class="btn btn-success">New Study Session</button>
                <button id="finishBtn" class="btn btn-success" style="display: none;">Finish</button>
                <button id="resetProgressBtn" class="btn btn-warning">Reset Progress</button>
                <button id="toggleAll" class="btn btn-primary">Show All Answers</button>
            </div>

        <div class="progress-section">
            <div class="progress-header">
                <h3>Progress</h3>
                <div class="score-display">
                    <span class="score-percentage" id="scorePercentage">0%</span>
                </div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill">
                        <span class="score-text">Score: <span id="score">0</span> / <span id="total">40</span></span>
                    </div>
                </div>
                <div class="accuracy-circle-container">
                    <div class="accuracy-circle" id="accuracyCircle">
                        <svg class="accuracy-circle-svg" viewBox="0 0 100 100">
                            <circle class="accuracy-circle-bg" cx="50" cy="50" r="45"></circle>
                            <circle class="accuracy-circle-progress" id="accuracyCircleProgress" cx="50" cy="50" r="45"></circle>
                        </svg>
                        <div class="accuracy-circle-text" id="accuracyCircleText">0%</div>
                    </div>
                </div>
            </div>
        </div>

            <div class="content" id="questionsContent">
                <!-- Questions will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Admin Panel (overlay) - Must be outside container for fixed positioning -->
    <div id="adminPanel" class="modal-overlay" style="display: none;">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h3>Admin Panel</h3>
                <button class="btn btn-secondary btn-small" id="closeAdminBtn">×</button>
            </div>
            <div id="adminContent" class="modal-body">
                <!-- Admin content will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Stats Modal (overlay) - Must be outside container for fixed positioning -->
    <div id="statsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content stats-modal">
            <div class="modal-header">
                <h3>Your Statistics</h3>
                <button class="btn btn-secondary btn-small" id="closeStatsBtn">×</button>
            </div>
            <div id="statsContent" class="modal-body">
                <!-- Stats will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Report Modal (overlay) -->
    <div id="reportModal" class="modal-overlay" style="display: none;">
        <div class="modal-content report-modal">
            <div class="modal-header">
                <h3>Report an Issue</h3>
                <button class="btn btn-secondary btn-small" id="closeReportBtn">×</button>
            </div>
            <div class="modal-body">
                <form id="reportForm">
                    <div style="margin-bottom: 20px;">
                        <label for="reportIssueType" style="display: block; margin-bottom: 8px; font-weight: 600;">Issue Type:</label>
                        <select id="reportIssueType" class="answer-input" required>
                            <option value="">Select an issue type...</option>
                            <option value="wrong_answer">Wrong Answer</option>
                            <option value="answer_should_be_accepted">Answer Should Be Accepted</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label for="reportDescription" style="display: block; margin-bottom: 8px; font-weight: 600;">Description:</label>
                        <textarea id="reportDescription" class="answer-input" rows="5" placeholder="Please describe the issue..." required></textarea>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" id="cancelReportBtn">Cancel</button>
                        <button type="submit" class="btn btn-warning">Submit Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Question Editor Modal (overlay) -->
    <div id="questionEditorModal" class="modal-overlay" style="display: none;">
        <div class="modal-content question-editor-modal">
            <div class="modal-header">
                <h3>Edit Question</h3>
                <button class="btn btn-secondary btn-small" id="closeQuestionEditorBtn">×</button>
            </div>
            <div class="modal-body">
                <form id="questionEditorForm">
                    <input type="hidden" id="editorQuestionId">
                    <div style="margin-bottom: 20px;">
                        <label for="editorQuestionText" style="display: block; margin-bottom: 8px; font-weight: 600;">Question Text:</label>
                        <textarea id="editorQuestionText" class="answer-input" rows="4" required></textarea>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label for="editorAnswer" style="display: block; margin-bottom: 8px; font-weight: 600;">Answer:</label>
                        <input type="text" id="editorAnswer" class="answer-input" required>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label for="editorCategory" style="display: block; margin-bottom: 8px; font-weight: 600;">Category:</label>
                        <select id="editorCategory" class="answer-input" required></select>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label for="editorCourse" style="display: block; margin-bottom: 8px; font-weight: 600;">Course:</label>
                        <select id="editorCourse" class="answer-input" required></select>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Alternative Answers:</label>
                        <div id="alternativeAnswersList"></div>
                        <button type="button" class="btn btn-secondary" id="addAlternativeBtn" style="margin-top: 10px;">Add Alternative Answer</button>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" id="cancelQuestionEditorBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Reset Progress Modal (overlay) -->
    <div id="resetProgressModal" class="modal-overlay" style="display: none;">
        <div class="modal-content reset-modal">
            <div class="modal-header">
                <h3 id="resetModalTitle">Reset Progress</h3>
                <button class="btn btn-secondary btn-small" id="closeResetModalBtn">×</button>
            </div>
            <div class="modal-body">
                <div id="resetModalContent">
                    <!-- Content will be populated by JavaScript -->
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelResetBtn">Cancel</button>
                    <button type="button" class="btn btn-warning" id="confirmResetBtn">Confirm Reset</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js?v=19"></script>
</body>
</html>

